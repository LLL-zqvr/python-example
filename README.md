# Python-example

### Introductions

该仓库记录的是一些有用的python小代码，可以实际帮助人们工作学习。
不定时更新~（等遇到python有用或者有意思的代码再放上来~）

### Development Environments

- **Pycharm**
- **Python3.6**

- **Git**

### Libraries
(起码需要用到这些。感觉如果python解释器用的是conda环境的会更好？这样就不用担心缺少哪些库了)<br>
jieba	0.42.1	0.42.1<br>
numpy	1.19.5	2.0.1<br>
openpyxl	3.1.3	3.1.5<br>
pandas	1.1.5	2.2.2<br>
pip	21.3.1	24.2<br>
xlrd	2.0.1	2.0.1<br>
### Update

##### 2024/7月

[code](../python-example/venv/test.py)
介绍：  

这是在单位实习时帮单位改进的代码。可以合并文件夹中的所有excle文件 
(不止.xlsx类型的文件，还兼容了.xls类型文件)。 <br>
但是在工作中发现，如果表格中有冻结窗格，表中多列数据会丢失。<br>
这当然是大家非常不愿意看到的。所以后来又加上了check代码， <br>
用来检查文件里是否有冻结窗格。(但是只能处理.xlsx文件，因为处理该类型文件的openpyxl库中有相应的检查代码，但是好像不存在免费的，可以检查.xls类型文件是否有冻结窗格的库。) <br>
通过多方查验，还是找到了可以处理.xls文件的方法——可以先用代码自动生成一个新的与.xls文件同名的.xlsx文件（储存路径相同），并将.xls文件的内容复制到新.xlsx文件中。无论之前的.xls文件是否有冻结窗格， <br>
生成的.xlsx文件是肯定不会有冻结窗格了且能保证内容完整。然后再修改了一下之前的代码，使得后面合并的大表只针对.xlsx文件（包括原.xlsx文件和与.xls文件同名的.xlsx文件）。此时就可以将代码 <br>
应用到工作之中了。如果.xlsx文件有冻结窗格，工作人员就可以根据控制台的提示找到文件并解除冻结窗格。 <br>
但是文件一多，一个个解除就会很麻烦，所以索性就加上了取消.xlsx文件的冻结窗格代码。<br> 
相应地，加上了提示——XXX表格有冻结窗格，已解除之类的。。方便如果后面有问题就可以和留底数据核验。<br> 
最后的最后，将解除冻结窗格的代码都丢进合并表的函数里面了，<br> 
要不然分开写函数的话还要多复制一次路径也太麻烦了。<br> 
不过写完代码没过多久就离职了（一开始以为可以做一些开发工作，但是发现这个实习多是手动处理数据，与愿相悖，再加上此实习非学校指定的社会实践类型，遂离去。），<br> 
所以不知道代码会有什么其他的问题。如果有人发现了这个代码有问题的可以和我联系~<br> 
这里贴上几个使用代码常见的报错和解决方法：<br> 
1. ...........zip之类的，说明文件设了密码，需要手动解密（也有可能是另一个错误，把文件夹中的文件全部复制到另一个文件然后再针对那个文件进行处理就行，我也不知道这是为什么。emmm反正这两种方法都试试吧忘了控制台错误提示大概是啥样的了）<br>
2. ....未包含....目标行之类的说明是相应表的标题行和代码中设置的行不一样。此时根据提示找到对应表改一下行就行。<br>
其他的好像就忘了....等我记起来再更新吧♪(´▽｀)


